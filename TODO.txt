OK from hyke import Packet -> inventarsi gli oggetti come collezioni di funzioni
OK variabili globali
OK multiple indents
OK dependencies
- expression list (oltre a argument list)
- define python
- +=, -= ...
- >> , <<
- mappe e liste?
- classificatore
from hyke import Loader
Loader.set(name='test', conf={'conf1': 5, 'conf2': 9})

{name: ‘xdd’, ‘configuration: {...}’}

##########################################################################

def mychain0():
    eth_type = Packet.readU16(12)
    if eth_type == 0x86dd :
        ttl = Packet.readU8(21)
        if ttl == 64:
            Packet.writeU8(17,21) 
        
    
    if eth_type == 0x800 :
        drop(eth_type)
        return

    allow(eth_type)
    return

##########################################################################

#include <hike_vm.h>
#define MYCHAIN0 78
#define HIKE_EBPF_PROG_DROP_ANY 12
#define HIKE_EBPF_PROG_ALLOW_ANY 11

HIKE_CHAIN(MYCHAIN0) {
    __s64 eth_type, ttl; 
    hike_packet_read_u16(&eth_type, 12);
    if ( eth_type == 0x86dd ) {
        hike_packet_read_u8(&ttl, 21);
        if ( ttl == 64 ) {
            hike_packet_write_u8(17, 21);
        }
    }
    if ( eth_type == 0x800 ) {
        hike_elem_call_2(HIKE_EBPF_PROG_DROP_ANY, eth_type);
        return 0;
    }
    hike_elem_call_2(HIKE_EBPF_PROG_ALLOW_ANY, eth_type);
    return 0;
    
}
##################################
hike_elem_call_2(HIKE_EBPF_PROG_DROP_ANY, {}) -> Stessa chiamata per ogni funzione hike con 2 parametri


Firewall.setup(["1,2,3,4", "4,5,6,7"])
Firewall.start()


MAP->"1.2.3.4"

1) esecuzione di codice (funzione hike)
2) inserimento di dati in mappe (+ creazione)
-----------
from pippo import nomefunzione

nomefunzione(parametri)
map[nomefunzione][nomemappa] = parametri


-----------
from pippo import Firewall

Firewall.setup(["1,2,3,4", "4,5,6,7"]) --> setup = nome mappa

Firewall.start() --> chiamata a funzione
-----------
SOluzioni per:
eth_type = Packet.readU16(12)

int x  = ({
    int tmp_
    hike_packet_(&tmp);
    tmp_
})


__u16 tmp_1
__s64 eth_type
packet_read(&tmp_1,12)

--------
SOluzioni per le hike calls:
MACRO preprocessore:

hike_elem_call_2(HIKE_CALL_ID_DROP, params)

dopo:
#define HIKE_CALL_ID_DROP 21